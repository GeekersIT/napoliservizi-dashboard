<mat-toolbar>
    <span>{{ 'Gestione quartieri'|translate }}</span>
    <span class="spacer"></span>
</mat-toolbar>
<div class="main-content">
    <table-component [source]="dataSource" [columns]="columns" [expandsTemplate]="expandsTemplate" [actionsTemplate]="actionsTemplate" [filterTemplate]="filterTemplate" [isLoading]="isLoading"></table-component>
</div>

<ng-template #filterTemplate>
    <form-component [options]="options" [model]="model" [fields]="fields" [actionsTemplate]="filterActionsTemplate" (resetEvent)="reset($event)"></form-component>
    <ng-template #filterActionsTemplate>
        <button mat-button (click)="applyFilter()">{{ 'Applica filtro'|translate }}</button>
    </ng-template>

    <ng-template let-option="option" #optionTemplate>
        {{ option.nome }}
    </ng-template>

</ng-template>

<ng-template let-row="row" #expandsTemplate>
    <div style="width: 30%;">
        <mat-list>
            <div mat-subheader>{{ 'Denominazione attuale'|translate }}</div>
            <mat-list-item >
              <div mat-line>{{ row.nome }}</div>
              <div mat-line> {{ 'Valida da {data}'|translate:{data:row.updated_at | date:'full':'it'} }} </div>
            </mat-list-item>
            <mat-divider></mat-divider>
            <div mat-subheader>{{ 'Vecchie denominazioni'|translate }}</div>
            <ng-container *ngIf="row.vecchie_denominazioni.length != 0; else empty">
                <mat-list-item  *ngFor="let denominazioni of row.vecchie_denominazioni;">
                    <div mat-line>{{ denominazioni.nome }}</div>
                    <div mat-line> {{ 'Valida fino a {data}'|translate:{data:denominazioni.created_at | date:'full':'it'} }} </div>
                </mat-list-item>
            </ng-container>
            <ng-template #empty>
                <mat-list-item>
                    <div mat-line style="font-size:14px">{{ 'Non ci sono vecchie denominazioni'|translate }}</div>
                </mat-list-item>
            </ng-template>
        </mat-list>
    </div>
    <div style="width: 70%">
        <mat-list>
            <div mat-subheader>{{ 'Municipalità attuale'|translate }}</div>
                <mat-list-item *ngFor="let municipalita of row.municipalita_attuale">
                  <div mat-line>{{ municipalita.municipalita.municipalita.nome }}</div>
                  <div mat-line>{{ 'Valida da {data}'|translate:{data:municipalita.municipalita.inizio_validita | date:'full':'it'} }}</div>
                </mat-list-item>
            <mat-divider></mat-divider>
            <div mat-subheader>{{ 'Vecchie municipalita'|translate }}</div>
            <ng-container *ngIf="row.vecchie_municipalita.length != 0; else empty1">
                <mat-list-item *ngFor="let municipalita of row.vecchie_municipalita">
                    <div mat-line>{{ municipalita.municipalita.municipalita.nome }}</div>
                    <div mat-line>{{ 'Valida fino a {data}'|translate:{data:municipalita.municipalita.fine_validita | date:'full':'it'} }}</div>
                  </mat-list-item>
            </ng-container>
            <ng-template #empty1>
                <mat-list-item>
                    <div mat-line style="font-size:14px">{{ 'Non ci sono vecchie municipalità'|translate }}</div>
                </mat-list-item>
            </ng-template>
        </mat-list>
    </div>
</ng-template>

<ng-template let-row="row" #actionsTemplate>
    <button mat-stroked-button color="accent" [routerLink]="['/','toponomastica','quartieri','edit',row.id]">
        <mat-icon>edit</mat-icon>
        {{ 'Modifica'|translate }}
    </button>
</ng-template>